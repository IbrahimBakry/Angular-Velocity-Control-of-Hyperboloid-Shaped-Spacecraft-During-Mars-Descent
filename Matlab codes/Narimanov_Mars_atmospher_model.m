% Narimanov Mars atmospher model
close all

h = 1000.*[0 5 10 15 20 30 40 50 60 70 80 90 100 110 120 130 140];
rho = [0.018 0.012 0.009 0.006 0.0037 0.0017 0.0006 0.00022 ...
    0.00006 0.000012 0.0000029 0.0000008 0.0000003 0.0000001 0.00000004...
    0.00000002 0.00000001];
plot(h,rho); hold all

% % format long
% Cypoly = polyfit(h,rho,3)
% 
% H = 0:1000:140000;
% RHO2 = 0.000000000001724.*H.^2 -0.000000313809903.*H + 0.012450398082315;  
% RHO3 = -(3.098655784885768e-17).*H.^3 + (8.168800841029225e-12).*H.^2 -(6.551803007456850e-07).*H + 0.015464638791723;
% RHOfit = polyval(Cypoly,H);
% 
% hold all
% % plot(H,RHO3)
% 
% [fitobject,gof,output] = fit(h',rho','smoothingspline')
% plot(fitobject)

h = 140000:-1000:0;
if h < 7000 T = -31.0 - 0.000998*h; else T = -23.4 - 0.002220*h; end
P = 0.699*exp(-0.00009*h);
rho2 = P./(0.15.*(T + 273.1));
plot(h,rho2)